var WL=(()=>{var Q=Object.defineProperty;var $=(l,t)=>{for(var e in t)Q(l,e,{get:t[e],enumerable:!0})};var wt={};$(wt,{Alignment:()=>it,Animation:()=>m,AnimationComponent:()=>O,AnimationState:()=>ot,Collider:()=>_t,CollisionComponent:()=>b,CollisionEventType:()=>lt,Component:()=>h,ForceMode:()=>k,InputComponent:()=>V,InputType:()=>p,Justification:()=>rt,LightComponent:()=>W,LightType:()=>st,Material:()=>g,Mesh:()=>N,MeshComponent:()=>X,MeshIndexType:()=>j,Object:()=>a,PhysXComponent:()=>U,Physics:()=>v,RayHit:()=>E,Scene:()=>M,Shape:()=>at,Skin:()=>C,TextComponent:()=>B,Texture:()=>A,Type:()=>nt,ViewComponent:()=>T,_images:()=>L,_initPhysics:()=>gt,_tempMem:()=>i,_tempMemFloat:()=>o,_tempMemInt:()=>f,_tempMemSize:()=>u,_tempMemUint16:()=>y,_tempMemUint32:()=>D,_tempMemUint8:()=>R,arSupported:()=>z,canvas:()=>Z,init:()=>pt,math:()=>K,onSceneLoaded:()=>ut,onXRSessionEnd:()=>dt,onXRSessionStart:()=>ct,onXRSupported:()=>ht,physics:()=>w,registerComponent:()=>et,scene:()=>G,textures:()=>J,updateTempMemory:()=>Y,vrSupported:()=>q,xrSession:()=>x});var tt="Misaligned pointer: please report a bug",P={},S=[];function et(l,t,e){_WL.registerComponent(l,t,e)}var nt={Bool:1<<1,Int:1<<2,Float:1<<3,String:1<<4,Enum:1<<5,Object:1<<6,Mesh:1<<7,Texture:1<<8,Material:1<<9,Animation:1<<10,Skin:1<<11};var _t={Sphere:0,AxisAlignedBox:1,Box:2};var it={Left:1,Center:2,Right:3};var rt={Line:1,Middle:2,Top:3};var p={Head:0,EyeLeft:1,EyeRight:2,ControllerLeft:3,ControllerRight:4,RayLeft:5,RayRight:6};var st={Point:1,Sun:2};var ot={Playing:1,Paused:2,Stopped:3};var k={Force:0,Impulse:1,VelocityChange:2,Acceleration:3};var lt={Touch:0,TouchLost:1};var at={None:0,Sphere:1,Capsule:2,Box:3,Plane:4,ConvexMesh:5,TriangleMesh:6};var Z=null,x=null,ct=[l=>{x=l}],dt=[()=>{x=null}],ht=[(l,t)=>{l=="ar"&&(z=t),l=="vr"&&(q=t)}],ut=[],z,q,G,w,L=[],i=null,u=1024,o=null,f=null,D=null,y=null,R=null;function pt(){G=new M,Z=typeof document=="undefined"?null:document.getElementById("canvas"),P={},S=[],i=_malloc(u),Y()}function gt(){w=new v}function Y(){o=new Float32Array(HEAP8.buffer,i,u>>4),f=new Int32Array(HEAP8.buffer,i,u>>4),D=new Uint32Array(HEAP8.buffer,i,u>>4),y=new Uint16Array(HEAP8.buffer,i,u>>2),R=new Uint8Array(HEAP8.buffer,i,u)}var M=class{constructor(){this._rayHit=_malloc(4*(3*4+3*4+4+2)+4),this._hit=new E(this._rayHit),this.onPreRender=[],this.onPostRender=[]}get activeViews(){let t=_wl_scene_get_active_views(i,16),e=[],n=a._typeIndexFor("view");for(let _=0;_<t;++_)e.push(new T(n,f[_]));return e}rayCast(t,e,n){return _wl_scene_ray_cast(t[0],t[1],t[2],e[0],e[1],e[2],n,this._rayHit),this._hit}addObject(t){let e=t?t.objectId:0,n=_wl_scene_add_object(e);return a._wrapObject(n)}addObjects(t,e,n){let _=e?e.objectId:0,r=_wl_scene_add_objects(_,t,n||0),s=Array.from(new Uint16Array(HEAPU16.buffer,r,t),d=>a._wrapObject(d));return _free(r),s}set clearColor(t){_wl_scene_set_clearColor(t[0],t[1],t[2],t[3])}load(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e),_wl_load_scene(n),_free(n)}};var h=class{constructor(t,e){this._id=e,this._manager=t}get type(){return this._type||a._typeNameFor(this._manager)}get object(){let t=_wl_component_get_object(this._manager,this._id);return a._wrapObject(t)}set active(t){_wl_component_setActive(this._manager,this._id,t)}get active(){return _wl_component_isActive(this._manager,this._id)!=0}equals(t){return t?this._manager==t._manager&&this._id==t._id:!1}};var b=class extends h{get collider(){return _wl_collision_component_get_collider(this._id)}set collider(t){_wl_collision_component_set_collider(this._id,t)}get extents(){return new Float32Array(HEAPF32.buffer,_wl_collision_component_get_extents(this._id),3)}set extents(t){this.extents.set(t)}get group(){return _wl_collision_component_get_group(this._id)}set group(t){_wl_collision_component_set_group(this._id,t)}queryOverlaps(){let t=_wl_collision_component_query_overlaps(this._id,i,u>>1),e=new Array(t);for(let n=0;n<t;++n)e[n]=new b(this._manager,y[n]);return e}};var B=class extends h{get alignment(){return _wl_text_component_get_alignment(this._id)&7}set alignment(t){_wl_text_component_set_alignment(this._id,this.justification<<3|t)}get justification(){return _wl_text_component_get_alignment(this._id)>>3}set justification(t){_wl_text_component_set_alignment(this._id,t<<3|this.alignment)}get text(){return UTF8ToString(_wl_text_component_get_text(this._id))}set text(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e),_wl_text_component_set_text(this._id,n),_free(n)}set material(t){_wl_text_component_set_material(this._id,t._index)}get material(){return g.wrap(_wl_text_component_get_material(this._id))}};var T=class extends h{get projectionMatrix(){return new Float32Array(HEAPF32.buffer,_wl_view_component_get_projection_matrix(this._id),16)}};var V=class extends h{get inputType(){return _wl_input_component_get_type(this._id)}set inputType(t){_wl_input_component_set_type(this._id,t)}get xrInputSource(){if(x){for(let t of x.inputSources)if(t.handedness==this.handedness)return t}return null}get handedness(){let t=this.inputType;return t==p.ControllerRight||t==p.RayRight||t==p.EyeRight?"right":t==p.ControllerLeft||t==p.RayLeft||t==p.EyeLeft?"left":null}};var W=class extends h{get color(){return new Float32Array(HEAPF32.buffer,_wl_light_component_get_color(this._id),4)}get lightType(){return _wl_light_component_get_type(this._id)}set lightType(t){return _wl_light_component_set_type(this._id,t)}};var O=class extends h{set animation(t){_wl_animation_component_set_animation(this._id,t._index)}get animation(){return new m(_wl_animation_component_get_animation(this._id))}set playCount(t){_wl_animation_component_set_playCount(this._id,t)}get playCount(){return _wl_animation_component_get_playCount(this._id)}play(){_wl_animation_component_play(this._id)}stop(){_wl_animation_component_stop(this._id)}pause(){_wl_animation_component_pause(this._id)}get state(){return _wl_animation_component_state(this._id)}};var X=class extends h{set material(t){_wl_mesh_component_set_material(this._id,t._index)}get material(){return g.wrap(_wl_mesh_component_get_material(this._id))}get mesh(){return new N(_wl_mesh_component_get_mesh(this._id))}set mesh(t){_wl_mesh_component_set_mesh(this._id,t._index)}get skin(){return new C(_wl_mesh_component_get_skin(this._id))}set skin(t){_wl_mesh_component_set_skin(this._id,t._index)}};var U=class extends h{set static(t){_wl_physx_component_set_static(this._id,t)}get static(){return!!_wl_physx_component_get_static(this._id)}set kinematic(t){_wl_physx_component_set_kinematic(this._id,t)}get kinematic(){return!!_wl_physx_component_get_kinematic(this._id)}set shape(t){_wl_physx_component_set_shape(this._id,t)}get shape(){return _wl_physx_component_get_shape(this._id)}set extents(t){this.extents.set(t)}get extents(){let t=_wl_physx_component_get_extents(this._id);return new Float32Array(HEAPF32.buffer,t,3)}get staticFriction(){return _wl_physx_component_get_staticFriction(this._id)}set staticFriction(t){_wl_physx_component_set_staticFriction(this._id,t)}get dynamicFriction(){return _wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(t){_wl_physx_component_set_dynamicFriction(this._id,t)}get restitution(){return _wl_physx_component_get_restitution(this._id)}set restitution(t){_wl_physx_component_set_restitution(this._id,t)}get linearDamping(){return _wl_physx_component_get_linearDamping(this._id)}set linearDamping(t){_wl_physx_component_set_linearDamping(this._id,t)}get angularDamping(){return _wl_physx_component_get_angularDamping(this._id)}set angularDamping(t){_wl_physx_component_set_angularDamping(this._id,t)}set linearVelocity(t){_wl_physx_component_set_linearVelocity(this._id,t[0],t[1],t[2])}get linearVelocity(){return _wl_physx_component_get_linearVelocity(this._id,i),new Float32Array(HEAPF32.buffer,i,3)}set angularVelocity(t){_wl_physx_component_set_angularVelocity(this._id,t[0],t[1],t[2])}get angularVelocity(){return _wl_physx_component_get_angularVelocity(this._id,i),new Float32Array(HEAPF32.buffer,i,3)}set mass(t){_wl_physx_component_set_mass(this._id,t)}get mass(){return _wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(t){_wl_physx_component_set_massSpaceInertiaTensor(this._id,t[0],t[1],t[2])}addForce(t,e,n,_,r){e=e||k.Force,_?_wl_physx_component_addForceAt(this._id,t[0],t[1],t[2],e,!!n,_[0],_[1],_[2],!!r):_wl_physx_component_addForce(this._id,t[0],t[1],t[2],e,!!n)}addTorque(t,e){e=e||k.Force,_wl_physx_component_addTorque(this._id,t[0],t[1],t[2],e)}onCollision(t){this.onCollisionWith(this,t)}onCollisionWith(t,e){w._callbacks[this._id]=w._callbacks[this._id]||[],w._callbacks[this._id].push(e),_wl_physx_component_addCallback(this._id,t._id||this._id)}};var v=class{constructor(){this._rayHit=_malloc(4*(3*4+3*4+4+2)+4),this._hit=new E(this._rayHit),this._callbacks={}}rayCast(t,e,n,_){return typeof _=="undefined"&&(_=100),_wl_physx_ray_cast(t[0],t[1],t[2],e[0],e[1],e[2],n,_||100,this._rayHit),this._hit}_callCollisionCallback(t,e,n,_){w._callbacks[t][e](n,new U(a._typeIndexFor("physx"),_))}};var N=class{static get VERTEX_FLOAT_SIZE(){return 3+3+2}static get VERTEX_SIZE(){return this.VERTEX_FLOAT_SIZE*4}static get POS(){return{X:0,Y:1,Z:2}}static get TEXCOORD(){return{U:3,V:4}}static get NORMAL(){return{X:5,Y:6,Z:7}}constructor(t){if(typeof t=="object"){t.indexType=t.indexType||j.UnsignedShort;let e=_malloc(t.indexData.length*t.indexType),n=_malloc(t.vertexData.length*4);switch(t.indexType){case j.UnsignedByte:HEAPU8.set(t.indexData,e);break;case j.UnsignedShort:HEAPU16.set(t.indexData,e>>1);break;case j.UnsignedInt:HEAPU32.set(t.indexData,e>>2);break}HEAPF32.set(t.vertexData,n>>2),this._index=_wl_mesh_create(e,t.indexData.length*t.indexType,t.indexType,n,t.vertexData.length*4)}else this._index=t}get vertexData(){let t=_wl_mesh_get_vertexData(this._index,i);return new Float32Array(HEAPF32.buffer,t,HEAPU32[i/4])}get indexData(){let t=_wl_mesh_get_indexData(this._index,i,i+4),e=HEAPU32[i/4];switch(HEAPU32[i/4+1]){case UnsignedByte:return new Uint8Array(HEAPU8.buffer,t,e);case UnsignedShort:return new Uint16Array(HEAPU16.buffer,t,e);case UnsignedInt:return new Uint32Array(HEAPU32.buffer,t,e)}}};var j={UnsignedByte:1,UnsignedShort:2,UnsignedInt:4};var g=class{constructor(t){this._index=t}get shader(){return UTF8ToString(_wl_material_get_shader(this._index))}clone(){return g.wrap(_wl_material_clone(this._index))}_paramIndex(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e);let _=_wl_material_get_param_index(this._index,n);return _free(n),_}_paramType(t){let e=_wl_material_get_param_type(this._index,t);return{type:e&255,componentCount:e>>8&255,metaType:e>>16&255}}static wrap(t){if(t<=0)return null;let e=new g(t);return new Proxy(e,{get(n,_){let r=n._paramIndex(_);if(r!=-1){let s=n._paramType(r);if(_wl_material_get_param_value(n._index,r,i)){if(s.type==0)return s.componentCount==1?D[0]:new Uint32Array(HEAPF32.buffer,i,s.componentCount);if(s.type==1)return s.componentCount==1?f[0]:new Int32Array(HEAPF32.buffer,i,s.componentCount);if(s.type==2)return s.componentCount==1?o[0]:new Float32Array(HEAPF32.buffer,i,s.componentCount);if(s.type==3)return new A(f[0])}throw new Error(`Invalid type ${s} on parameter ${r} for material ${n._index}`)}else return n[_]},set(n,_,r){let s=n._paramIndex(_);if(s>=0)if(r instanceof A)_wl_material_set_param_value_uint(n._index,s,r._id);else if(typeof r=="number")o[0]=r,_wl_material_set_param_value_float(n._index,s,i,1);else{let d=r.length;for(let c=0;c<d;++c)o[c]=r[c];_wl_material_set_param_value_float(n._index,s,i,d)}else n[_]=r;return!0}})}};var A=class{constructor(t){if(t instanceof HTMLImageElement||t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement){let e=L.length;L.push(t),this._imageIndex=e,this._id=_wl_renderer_addImage(e)}else this._id=t;J[this._id]=this}get valid(){return this._id>=0}update(){!this.valid||_wl_renderer_updateTexture(this._id,this._imageIndex)}};var J={load:function(l,t){let e=new Image;return t!==void 0&&(e.crossOrigin=t),e.src=l,new Promise((n,_)=>{e.onload=function(){let r=new A(e);r.valid||_("Failed to add image "+e.src+" to texture atlas. Probably incompatible format."),n(r)}})}},m=class{constructor(t){this._index=t}get duration(){return _wl_animation_get_duration(this._index)}get trackCount(){return _wl_animation_get_trackCount(this._index)}retarget(t){if(t instanceof C){let _=_wl_animation_retargetToSkin(this._index,t._index);return new m(_)}if(t.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+t.length.toString());let e=_malloc(2*t.length);for(let _=0;_<t.length;++_)HEAPU16[e>>1+_]=t[_].objectId;let n=_wl_animation_retarget(this._index,e);return _free(e),new m(n)}};var a=class{constructor(t){this.objectId=t}get name(){return UTF8ToString(_wl_object_name(this.objectId))}set name(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e),_wl_object_set_name(this.objectId,n),_free(n)}get parent(){let t=_wl_object_parent(this.objectId);return t==0?null:a._wrapObject(t)}get children(){let t=_wl_object_get_children(this.objectId,i,u>>1);if(t==0)return[];let e=new Array(t);for(let n=0;n<t;++n)e[n]=a._wrapObject(y[n]);return e}set parent(t){_wl_object_set_parent(this.objectId,t==null?0:t.objectId)}resetTransform(){_wl_object_reset_translation_rotation(this.objectId),_wl_object_reset_scaling(this.objectId)}resetTranslationRotation(){_wl_object_reset_translation_rotation(this.objectId)}resetRotation(){_wl_object_reset_rotation(this.objectId)}resetTranslation(){_wl_object_reset_translation(this.objectId)}resetScaling(){_wl_object_reset_scaling(this.objectId)}translate(t){_wl_object_translate(this.objectId,t[0],t[1],t[2])}translateObject(t){_wl_object_translate_obj(this.objectId,t[0],t[1],t[2])}translateWorld(t){_wl_object_translate_world(this.objectId,t[0],t[1],t[2])}rotateAxisAngleDeg(t,e){_wl_object_rotate_axis_angle(this.objectId,t[0],t[1],t[2],e)}rotateAxisAngleRad(t,e){_wl_object_rotate_axis_angle_rad(this.objectId,t[0],t[1],t[2],e)}rotateAxisAngleDegObject(t,e){_wl_object_rotate_axis_angle_obj(this.objectId,t[0],t[1],t[2],e)}rotateAxisAngleRadObject(t,e){_wl_object_rotate_axis_angle_rad_obj(this.objectId,t[0],t[1],t[2],e)}rotate(t){_wl_object_rotate_quat(this.objectId,t[0],t[1],t[2],t[3])}rotateObject(t){_wl_object_rotate_quat_obj(this.objectId,t[0],t[1],t[2],t[3])}scale(t){_wl_object_scale(this.objectId,t[0],t[1],t[2])}get transformLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_local(this.objectId),8)}set transformLocal(t){this.transformLocal.set(t),this.setDirty()}getTranslationLocal(t){return _wl_object_get_translation_local(this.objectId,i),t[0]=o[0],t[1]=o[1],t[2]=o[2],t}getTranslationWorld(t){return _wl_object_get_translation_world(this.objectId,i),t[0]=o[0],t[1]=o[1],t[2]=o[2],t}setTranslationLocal(t){_wl_object_set_translation_local(this.objectId,t[0],t[1],t[2])}setTranslationWorld(t){_wl_object_set_translation_world(this.objectId,t[0],t[1],t[2])}get transformWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_world(this.objectId),8)}set transformWorld(t){this.transformWorld.set(t),_wl_object_trans_world_to_local(this.objectId)}get scalingLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_local(this.objectId),3)}get scalingWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_world(this.objectId),3)}getForward(t){return _wl_object_get_forward(this.objectId,i),t[0]=o[0],t[1]=o[1],t[2]=o[2],t}getUp(t){return _wl_object_get_up(this.objectId,i),t[0]=o[0],t[1]=o[1],t[2]=o[2],t}getRight(t){return _wl_object_get_right(this.objectId,i),t[0]=o[0],t[1]=o[1],t[2]=o[2],t}lookAt(t,e=[0,1,0]){_wl_object_lookAt(this.objectId,t[0],t[1],t[2],e[0],e[1],e[2])}destroy(){_wl_scene_remove_object(this.objectId),this.objectId=null}setDirty(){_wl_object_set_dirty(this.objectId)}set active(t){let e=this.getComponents();for(let n of e)n.active=t}getComponent(t,e){let n=lengthBytesUTF8(t)+1,_=_malloc(n);stringToUTF8(t,_,n);let r=_wl_get_component_manager_index(_);if(r<0){let d=_wl_get_js_component_index(this.objectId,_,e||0);return _free(_),d<0?null:_WL._components[d]}_free(_);let s=_wl_get_component_id(this.objectId,r,e||0);return a._wrapComponent(t,r,s)}getComponents(t){let e=t?a._typeIndexFor(t):null,n=[],_=Math.floor(u/3*2),r=_wl_object_get_components(this.objectId,i,_),s=2*r;_wl_object_get_component_types(this.objectId,i+s,_);let d=a._typeIndexFor("js");for(let c=0;c<r;++c){let F=R[c+s],H=y[c];if(F==d){let I=_WL._components[_wl_get_js_component_index_for_id(H)];(e===null||I.type==t)&&n.push(I);continue}if(e===null){let I=a._typeNameFor(F);n.push(a._wrapComponent(I,F,H))}else F==e&&n.push(a._wrapComponent(t,e,H))}return n}addComponent(t,e){let n=a._typeIndexFor(t);if(n<0){if(!(t in _WL._componentTypeIndices))throw new TypeError("Unknown component type '"+t+"'");let s=_wl_object_add_js_component(this.objectId,_WL._componentTypeIndices[t]),d=_wl_get_js_component_index_for_id(s),c=_WL._components[d];if(e!==void 0)for(key in e)key!="active"&&(c[key]=e[key]);return _wljs_component_init(d),(!e||!("active"in e&&!e.active))&&(c.active=!0),c}let _=_wl_object_add_component(this.objectId,n),r=a._wrapComponent(t,n,_);if(e!==void 0)for(key in e)r[key]=e[key];return r.active=!0,r}equals(t){return t?this.objectId==t.objectId:!1}static _typeIndexFor(t){let e=lengthBytesUTF8(t)+1,n=_malloc(e);stringToUTF8(t,n,e);let _=_wl_get_component_manager_index(n);return _free(n),_}static _typeNameFor(t){return UTF8ToString(_wl_component_manager_name(t))}static _wrapComponent(t,e,n){if(n<0)return null;let _=P[e]||(P[e]=[]);return t=="collision"?_[n]||(_[n]=new b(e,n)):t=="text"?_[n]||(_[n]=new B(e,n)):t=="view"?_[n]||(_[n]=new T(e,n)):t=="mesh"?_[n]||(_[n]=new X(e,n)):t=="input"?_[n]||(_[n]=new V(e,n)):t=="light"?_[n]||(_[n]=new W(e,n)):t=="animation"?_[n]||(_[n]=new O(e,n)):t=="physx"?_[n]||(_[n]=new U(e,n)):_[n]||(_[n]=new h(e,n))}static _wrapObject(t){return S[t]||(S[t]=new a(t))}},C=class{constructor(t){this._index=t}get jointCount(){return _wl_skin_get_joint_count(this._index)}get jointIds(){return new Uint16Array(HEAPU16.buffer,_wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}};var E=class{constructor(t){assert((this._ptr&3)==0,tt),this._ptr=t}get locations(){let t=this._ptr,e=[];for(let n=0;n<this.hitCount;++n)e.push(new Float32Array(HEAPF32.buffer,t+12*n,3));return e}get normals(){let t=this._ptr+48,e=[];for(let n=0;n<this.hitCount;++n)e.push(new Float32Array(HEAPF32.buffer,t+12*n,3));return e}get distances(){let t=this._ptr+48*2;return new Float32Array(HEAPF32.buffer,t,this.hitCount)}get objects(){let t=this._ptr+(48*2+16),e=new Uint16Array(HEAPU16.buffer,t,this.hitCount);return[e[0]<=0?null:a._wrapObject(e[0]),e[1]<=0?null:a._wrapObject(e[1]),e[2]<=0?null:a._wrapObject(e[2]),e[3]<=0?null:a._wrapObject(e[3])]}get hitCount(){return Math.min(HEAPU32[this._ptr/4+30],4)}};var K=class{static cubicHermite(t,e,n,_,r,s){return o.subarray(0).set(e),o.subarray(3).set(n),o.subarray(6).set(_),o.subarray(9).set(r),_wl_math_cubicHermite(i+4*12,i+4*0,i+4*3,i+4*6,i+4*9,s),t[0]=o[12],t[1]=o[13],t[2]=o[14],t}};return wt;})();
//# sourceMappingURL=wonderland.min.js.map
